/**
 * Loads AWS Kinesis tracker.
 *
 * @copyright Copyright (c) 2020 Open LMS
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_liquidus/kinesis-lazy",["jquery","core/log"],(function($,Log){var self=this,tracker={};return self.addAnalyticsJS=function(){var dfd=$.Deferred();return tracker.trackerInfo.kinesisURL?(dfd.resolve(!0),dfd):(Log.debug("Liquidus is misconfigured for AWS Kinesis, Kinesis URL is missing."),null)},tracker.loadTracker=function(trackerInfo){return tracker.trackerInfo=trackerInfo,self.addAnalyticsJS()},tracker.identify=function(){$.ajax({url:tracker.trackerInfo.kinesisURL,method:"POST",headers:tracker.trackerInfo.staticShares}).done((function(){Log.debug("Liquidus identified with kinesis.")}))},tracker.trackPage=function(){$.ajax({url:tracker.trackerInfo.kinesisURL,method:"POST",headers:{userHash:tracker.trackerInfo.staticShares.userHash,page:window.location.pathname.split("/").slice(-1),referrer_page:document.referrer,custom_metric_name:"userAgent",custom_metric_string_value:navigator.userAgent}}).done((function(){Log.debug("Liquidus sent page to kinesis.")}))},tracker.heartBeat=function(){$.ajax({url:tracker.trackerInfo.kinesisURL,method:"POST",headers:{userHash:tracker.trackerInfo.staticShares.userHash,custom_metric_name:"heartBeat",custom_metric_string_value:1}}).done((function(){Log.debug("Liquidus sent heart beat to kinesis.")}))},tracker.processEvent=function(dfd,metricName,data){$.ajax({url:tracker.trackerInfo.kinesisURL,method:"POST",headers:{userHash:tracker.trackerInfo.staticShares.userHash,custom_metric_name:metricName,custom_metric_string_value:JSON.stringify(data)}}).done((function(){dfd.resolve(!0),Log.debug("AWS Kinesis promise resolved.")}))},tracker}));

//# sourceMappingURL=kinesis-lazy.min.js.map