{"version":3,"file":"settings-handler-lazy.min.js","sources":["../src/settings-handler-lazy.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Liquidus settings initializer.\n *\n * @module     local_liquidus/settings-handler-lazy\n * @copyright  Copyright (c) 2021 Open LMS (https://www.openlms.net)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport Templates from 'core/templates';\n\n/**\n * Moves setting sections to tabs.\n * @param {Array} types\n */\nconst moveSectionsToTabs = (types) => {\n    const settingsNode = $('#page-admin-setting-local_liquidus .settingsform fieldset');\n    if (settingsNode.length === 0) {\n        return;\n    }\n    Templates.render('local_liquidus/settings_tabs', {}).then((html) => {\n        // Create tab structure.\n        settingsNode.append(html);\n        const tabNode = $('#local_liquidus-settings-nav-tab');\n        const contentNode = $('#local_liquidus-settings-nav-content');\n        let activeFirst = true;\n        for (const i in types) {\n            const type = types[i];\n            // Base selector is the enabling checkbox.\n            const providerEnablingNode = $(`#id_s_local_liquidus_${type}`);\n            // Find formsetingheading.\n            const headingNode = providerEnablingNode.parent().parent().parent().prev();\n            // Find title h3.\n            const titleNode = headingNode.prev();\n            // Get all rows that correspond to setting inputs.\n            const settingRows = $(`div[id^=admin-${type}`);\n            // Move title to nav.\n            Templates.render('local_liquidus/settings_tabs_nav_link', {\n                id: type,\n                title: titleNode.text(),\n                active: activeFirst,\n            }).then((navHtml) => {\n                tabNode.append(navHtml);\n                titleNode.remove();\n            });\n\n            // Move content to div.\n            Templates.render('local_liquidus/settings_tabs_nav_content', {\n                id: type,\n                active: activeFirst,\n            }).then((contentHtml) => {\n                contentNode.append(contentHtml);\n                headingNode.detach().appendTo(`#local_liquidus-nav-${type}`);\n                settingRows.detach().appendTo(`#local_liquidus-nav-${type}`);\n            });\n\n            activeFirst = false;\n        }\n    });\n};\n\n/**\n * Initializer.\n * @param {Array} types\n */\nexport const init = (types) => {\n    (function() {\n        moveSectionsToTabs(types);\n    })();\n};"],"names":["types","settingsNode","length","render","then","html","append","tabNode","contentNode","activeFirst","i","type","headingNode","parent","prev","titleNode","settingRows","id","title","text","active","navHtml","remove","contentHtml","detach","appendTo","moveSectionsToTabs"],"mappings":";;;;;;;sLAgFqBA,QAlDOA,CAAAA,cAClBC,cAAe,mBAAE,6DACK,IAAxBA,aAAaC,2BAGPC,OAAO,+BAAgC,IAAIC,MAAMC,OAEvDJ,aAAaK,OAAOD,YACdE,SAAU,mBAAE,oCACZC,aAAc,mBAAE,4CAClBC,aAAc,MACb,MAAMC,KAAKV,MAAO,OACbW,KAAOX,MAAMU,GAIbE,aAFuB,kDAA0BD,OAEdE,SAASA,SAASA,SAASC,OAE9DC,UAAYH,YAAYE,OAExBE,aAAc,2CAAmBL,0BAE7BR,OAAO,wCAAyC,CACtDc,GAAIN,KACJO,MAAOH,UAAUI,OACjBC,OAAQX,cACTL,MAAMiB,UACLd,QAAQD,OAAOe,SACfN,UAAUO,+BAIJnB,OAAO,2CAA4C,CACzDc,GAAIN,KACJS,OAAQX,cACTL,MAAMmB,cACLf,YAAYF,OAAOiB,aACnBX,YAAYY,SAASC,uCAAgCd,OACrDK,YAAYQ,SAASC,uCAAgCd,UAGzDF,aAAc,OAWlBiB,CAAmB1B"}